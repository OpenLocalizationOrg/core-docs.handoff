{"nodes":[{"pos":[11,42],"content":"Collections and Data Structures","needQuote":true,"nodes":[{"content":"Collections and Data Structures","pos":[0,31]}]},{"pos":[56,87],"content":"Collections and Data Structures","needQuote":true,"nodes":[{"content":"Collections and Data Structures","pos":[0,31]}]},{"pos":[98,113],"content":".NET, .NET Core","needQuote":true,"nodes":[{"content":".NET, .NET Core","pos":[0,15]}]},{"content":"Collections and Data Structures","pos":[317,348]},{"content":"Similar data can often be handled more efficiently when stored and manipulated as a collection.","pos":[350,445]},{"content":"You can use the <bpt id=\"p1\">[</bpt>System.Array<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Array)</ept> class or the classes in the <bpt id=\"p2\">[</bpt>System.Collections<ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections)</ept>, <bpt id=\"p3\">[</bpt>System.Collections.Generic<ept id=\"p3\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic)</ept>, or <bpt id=\"p4\">[</bpt>System.Collections.Concurrent<ept id=\"p4\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent)</ept> namespaces to add, remove, and modify either individual elements or a range of elements in a collection.","pos":[446,961],"source":" You can use the [System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array) class or the classes in the [System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections), [System.Collections.Generic](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic), or [System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent) namespaces to add, remove, and modify either individual elements or a range of elements in a collection."},{"content":"There are two main types of collections; generic collections and non-generic collections.","pos":[963,1052]},{"content":"Generic collections are type-safe at compile time.","pos":[1053,1103]},{"content":"Because of this, generic collections typically offer better performance.","pos":[1104,1176]},{"content":"Generic collections accept a type parameter when they are constructed and do not require that you cast to and from the <bpt id=\"p1\">[</bpt>Object<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Object)</ept> type when you add or remove items from the collection.","pos":[1177,1417],"source":" Generic collections accept a type parameter when they are constructed and do not require that you cast to and from the [Object](https://docs.microsoft.com/dotnet/core/api/System.Object) type when you add or remove items from the collection."},{"content":"Non-generic collections store items as <bpt id=\"p1\">[</bpt>Object<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Object)</ept> and require casting.","pos":[1418,1544],"source":" Non-generic collections store items as [Object](https://docs.microsoft.com/dotnet/core/api/System.Object) and require casting."},{"content":"You may see non-generic collections in older code.","pos":[1545,1595]},{"pos":[1597,1830],"content":"The collections in the <bpt id=\"p1\">[</bpt>System.Collections.Concurrent<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent)</ept> namespace provide efficient thread-safe operations for accessing collection items from multiple threads.","source":"The collections in the [System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent) namespace provide efficient thread-safe operations for accessing collection items from multiple threads."},{"content":"Common collection features","pos":[1835,1861]},{"content":"All collections provide methods for adding, removing or finding items in the collection.","pos":[1863,1951]},{"content":"In addition, all collections that directly or indirectly implement the <bpt id=\"p1\">[</bpt>ICollection<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.ICollection)</ept> interface or the <bpt id=\"p2\">[</bpt>ICollection<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.ICollection-1)</ept> interface share these features:","pos":[1952,2268],"source":" In addition, all collections that directly or indirectly implement the [ICollection](https://docs.microsoft.com/dotnet/core/api/System.Collections.ICollection) interface or the [ICollection&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.ICollection-1) interface share these features:"},{"content":"The ability to enumerate the collection","pos":[2275,2314]},{"content":".NET Framework collections either implement <bpt id=\"p1\">[</bpt>System.Collections.IEnumerable<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.IEnumerable)</ept> or <bpt id=\"p2\">[</bpt>System.Collections.Generic.IEnumerable<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IEnumerable-1)</ept> to enable the collection to be iterated through.","pos":[2321,2659],"source":".NET Framework collections either implement [System.Collections.IEnumerable](https://docs.microsoft.com/dotnet/core/api/System.Collections.IEnumerable) or [System.Collections.Generic.IEnumerable&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IEnumerable-1) to enable the collection to be iterated through."},{"content":"An enumerator can be thought of as a movable pointer to any element in the collection.","pos":[2660,2746]},{"content":"The <ph id=\"ph1\">`foreach, in`</ph> statement (C#) uses the enumerator exposed by the <ph id=\"ph2\">`GetEnumerator`</ph> method and hides the complexity of manipulating the enumerator.","pos":[2747,2894],"source":" The `foreach, in` statement (C#) uses the enumerator exposed by the `GetEnumerator` method and hides the complexity of manipulating the enumerator."},{"content":"In addition, any collection that implements <bpt id=\"p1\">[</bpt>System.Collections.Generic.IEnumerable<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IEnumerable-1)</ept> is considered a queryable type and can be queried with LINQ.","pos":[2895,3134],"source":" In addition, any collection that implements [System.Collections.Generic.IEnumerable&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IEnumerable-1) is considered a queryable type and can be queried with LINQ."},{"content":"LINQ queries provide a common pattern for accessing data.","pos":[3135,3192]},{"content":"They are typically more concise and readable than standard for each loops, and provide filtering, ordering and grouping capabilities.","pos":[3193,3326]},{"content":"LINQ queries can also improve performance.","pos":[3327,3369]},{"content":"The ability to copy the collection contents to an array","pos":[3379,3434]},{"content":"All collections can be copied to an array using the <ph id=\"ph1\">`CopyTo`</ph> method; however, the order of the elements in the new array is based on the sequence in which the enumerator returns them.","pos":[3441,3624],"source":"All collections can be copied to an array using the `CopyTo` method; however, the order of the elements in the new array is based on the sequence in which the enumerator returns them."},{"content":"The resulting array is always one-dimensional with a lower bound of zero.","pos":[3625,3698]},{"content":"In addition, many collection classes contain the following features:","pos":[3704,3772]},{"content":"Capacity and Count properties","pos":[3778,3807]},{"content":"The capacity of a collection is the number of elements it can contain.","pos":[3814,3884]},{"content":"The count of a collection is the number of elements it actually contains.","pos":[3885,3958]},{"content":"Some collections hide the capacity or the count or both.","pos":[3959,4015]},{"content":"Most collections automatically expand in capacity when the current capacity is reached.","pos":[4024,4111]},{"content":"The memory is reallocated, and the elements are copied from the old collection to the new one.","pos":[4112,4206]},{"content":"This reduces the code required to use the collection; however, the performance of the collection might be negatively affected.","pos":[4207,4333]},{"content":"For example, for <bpt id=\"p1\">[</bpt>List<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1)</ept>, if <ph id=\"ph3\">`Count`</ph> is less than <ph id=\"ph4\">`Capacity`</ph>, adding an item is an O(1) operation.","pos":[4334,4518],"source":" For example, for [List&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1), if `Count` is less than `Capacity`, adding an item is an O(1) operation."},{"content":"If the capacity needs to be increased to accommodate the new element, adding an item becomes an O(n) operation, where n is <ph id=\"ph1\">`Count`</ph>.","pos":[4519,4650],"source":" If the capacity needs to be increased to accommodate the new element, adding an item becomes an O(n) operation, where n is `Count`."},{"content":"The best way to avoid poor performance caused by multiple reallocations is to set the initial capacity to be the estimated size of the collection.","pos":[4651,4797]},{"pos":[4807,4982],"content":"A <bpt id=\"p1\">[</bpt>BitArray<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.BitArray)</ept> is a special case; its capacity is the same as its length, which is the same as its count.","source":"A [BitArray](https://docs.microsoft.com/dotnet/core/api/System.Collections.BitArray) is a special case; its capacity is the same as its length, which is the same as its count."},{"content":"A consistent lower bound","pos":[4994,5018]},{"content":"The lower bound of a collection is the index of its first element.","pos":[5025,5091]},{"content":"All indexed collections in the <bpt id=\"p1\">[</bpt>System.Collections<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections)</ept> namespaces have a lower bound of zero, meaning they are 0-indexed.","pos":[5092,5273],"source":" All indexed collections in the [System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections) namespaces have a lower bound of zero, meaning they are 0-indexed."},{"content":"<bpt id=\"p1\">[</bpt>Array<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Array)</ept> has a lower bound of zero by default, but a different lower bound can be defined when creating an instance of the <ph id=\"ph1\">`Array`</ph> class using <ph id=\"ph2\">`Array.CreateInstance`</ph>.","pos":[5274,5496],"source":"[Array](https://docs.microsoft.com/dotnet/core/api/System.Array) has a lower bound of zero by default, but a different lower bound can be defined when creating an instance of the `Array` class using `Array.CreateInstance`."},{"pos":[5502,5654],"content":"<bpt id=\"p1\">**</bpt>Synchronization for access from multiple threads<ept id=\"p1\">**</ept> (<bpt id=\"p2\">[</bpt>System.Collections<ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections)</ept> classes only).","source":"**Synchronization for access from multiple threads** ([System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections) classes only)."},{"content":"Non-generic collection types in the <bpt id=\"p1\">[</bpt>System.Collections<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections)</ept> namespace provide some thread safety with synchronization; typically exposed through the <ph id=\"ph1\">`SyncRoot`</ph> and <ph id=\"ph2\">`IsSynchronized`</ph> members.","pos":[5659,5908],"source":"Non-generic collection types in the [System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections) namespace provide some thread safety with synchronization; typically exposed through the `SyncRoot` and `IsSynchronized` members."},{"content":"These collections are not thread-safe by default.","pos":[5909,5958]},{"content":"If you require scalable and efficient multi-threaded access to a collection, use one of the classes in the <bpt id=\"p1\">[</bpt>System.Collections.Concurrent<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent)</ept> namespace or consider using an immutable collection.","pos":[5959,6224],"source":" If you require scalable and efficient multi-threaded access to a collection, use one of the classes in the [System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent) namespace or consider using an immutable collection."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Thread-Safe Collections<ept id=\"p1\">](threadsafe/index.md)</ept>.","pos":[6225,6298],"source":" For more information, see [Thread-Safe Collections](threadsafe/index.md)."},{"content":"Choosing a collection","pos":[6311,6332]},{"content":"In general, you should use generic collections.","pos":[6335,6382]},{"content":"The following table describes some common collection scenarios and the collection classes you can use for those scenarios.","pos":[6383,6505]},{"content":"If you are new to generic collections, this table will help you choose the generic collection that works the best for your task.","pos":[6506,6634]},{"content":"I want to…","pos":[6636,6646]},{"content":"Generic collection option(s)","pos":[6649,6677]},{"content":"Non-generic collection option(s)","pos":[6680,6712]},{"content":"Store items as key/value pairs for quick look-up by key","pos":[6790,6845]},{"content":"System.Collections.Generic.Dictionary<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue","pos":[6849,6902],"source":"System.Collections.Generic.Dictionary&lt;TKey, TValue"},{"content":"Hashtable","pos":[6995,7004]},{"content":"Access items by index","pos":[7079,7100]},{"content":"System.Collections.Generic.List<ph id=\"ph1\">&amp;lt;</ph>T","pos":[7104,7140],"source":"System.Collections.Generic.List&lt;T"},{"pos":[7226,7402],"content":"<bpt id=\"p1\">[</bpt>System.Array<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Array)</ept>, <bpt id=\"p2\">[</bpt>System.Collections.ArrayList<ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.ArrayList)</ept>","source":"[System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array), [System.Collections.ArrayList](https://docs.microsoft.com/dotnet/core/api/System.Collections.ArrayList)"},{"content":"Use items first-in-first-out (FIFO)","pos":[7403,7438]},{"content":"System.Collections.Generic.Queue<ph id=\"ph1\">&amp;lt;</ph>T","pos":[7442,7479],"source":"System.Collections.Generic.Queue&lt;T"},{"content":"System.Collections.Queue","pos":[7567,7591]},{"content":"Use data Last-In-First-Out (LIFO)","pos":[7662,7695]},{"content":"System.Collections.Generic.Stack<ph id=\"ph1\">&amp;lt;</ph>T","pos":[7699,7736],"source":"System.Collections.Generic.Stack&lt;T"},{"content":"System.Collections.Stack","pos":[7824,7848]},{"content":"Access items sequentially","pos":[7919,7944]},{"content":"System.Collections.Generic.LinkedList<ph id=\"ph1\">&amp;lt;</ph>T","pos":[7948,7990],"source":"System.Collections.Generic.LinkedList&lt;T"},{"content":"No recommendation","pos":[8082,8099]},{"content":"Receive notifications when items are removed or added to the collection.","pos":[8100,8172]},{"content":"(implements <bpt id=\"p1\">[</bpt>INotifyPropertyChanged<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.ComponentModel.INotifyPropertyChanged)</ept> and <bpt id=\"p2\">[</bpt>INotifyCollectionChanged<ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Specialized.INotifyCollectionChanged)</ept>)","pos":[8173,8430],"source":" (implements [INotifyPropertyChanged](https://docs.microsoft.com/dotnet/core/api/System.ComponentModel.INotifyPropertyChanged) and [INotifyCollectionChanged](https://docs.microsoft.com/dotnet/core/api/System.Collections.Specialized.INotifyCollectionChanged))"},{"content":"System.Collections.ObjectModel.ObservableCollection<ph id=\"ph1\">&amp;lt;</ph>T","pos":[8434,8490],"source":"System.Collections.ObjectModel.ObservableCollection&lt;T"},{"content":"No recommendation","pos":[8596,8613]},{"content":"Use a sorted collection","pos":[8614,8637]},{"content":"System.Collections.Generic.SortedList<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue","pos":[8641,8694],"source":"System.Collections.Generic.SortedList&lt;TKey, TValue"},{"content":"System.Collections.SortedList","pos":[8787,8816]},{"content":"Manage efficient storage and access of unique elements","pos":[8892,8946]},{"pos":[8949,9207],"content":"<bpt id=\"p1\">[</bpt>System.Collections.Generic.HashSet<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.HashSet-1)</ept>, <bpt id=\"p2\">[</bpt>System.Collections.Generic.SortedSet<ph id=\"ph3\">&amp;lt;</ph>T<ph id=\"ph4\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedSet-1)</ept>","source":"[System.Collections.Generic.HashSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.HashSet-1), [System.Collections.Generic.SortedSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedSet-1)"},{"content":"No recommendation","pos":[9210,9227]},{"content":"Related Topics","pos":[9232,9246]},{"content":"Title","pos":[9248,9253]},{"content":"Description","pos":[9256,9267]},{"content":"Selecting a Collection Class","pos":[9289,9317]},{"content":"Describes the different collections and helps you select one for your scenario.","pos":[9354,9433]},{"content":"Commonly Used Collection Types","pos":[9435,9465]},{"pos":[9504,9919],"content":"Describes commonly used generic and nongeneric collection types such as <bpt id=\"p1\">[</bpt>System.Array<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Array)</ept>, <bpt id=\"p2\">[</bpt>System.Collections.Generic.List<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1)</ept>, and <bpt id=\"p3\">[</bpt>System.Collections.Generic.Dictionary<ph id=\"ph3\">&amp;lt;</ph>TKey, TValue<ph id=\"ph4\">&amp;gt;</ph><ept id=\"p3\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2)</ept>.","source":"Describes commonly used generic and nongeneric collection types such as [System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array), [System.Collections.Generic.List&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1), and [System.Collections.Generic.Dictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2)."},{"content":"When to Use Generic Collections","pos":[9922,9953]},{"content":"Discusses the use of generic collection types.","pos":[9993,10039]},{"content":"Comparisons and Sorts Within Collections","pos":[10041,10081]},{"content":"Discusses the use of equality comparisons and sorting comparisons in collections.","pos":[10130,10211]},{"content":"Sorted Collection Types","pos":[10213,10236]},{"content":"Describes sorted collections performance and characteristics.","pos":[10268,10329]},{"content":"Hashtable and Dictionary Collection Types","pos":[10331,10372]},{"content":"Describes the features of generic and non-generic hash-based dictionary types.","pos":[10422,10500]},{"content":"Thread-Safe Collections","pos":[10502,10525]},{"pos":[10550,10961],"content":"Describes collection types such as <bpt id=\"p1\">[</bpt>System.Collections.Concurrent.BlockingCollection<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.BlockingCollection-1)</ept> and <bpt id=\"p2\">[</bpt>System.Collections.Concurrent.ConcurrentBag<ph id=\"ph3\">&amp;lt;</ph>T<ph id=\"ph4\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentBag-1)</ept> that support safe and efficient concurrent access from multiple threads.","source":"Describes collection types such as [System.Collections.Concurrent.BlockingCollection&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.BlockingCollection-1) and [System.Collections.Concurrent.ConcurrentBag&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentBag-1) that support safe and efficient concurrent access from multiple threads."},{"content":"Reference","pos":[10966,10975]},{"content":"System.Array","pos":[10978,10990]},{"content":"System.Collections","pos":[11051,11069]},{"content":"System.Collections.Concurrent","pos":[11136,11165]},{"content":"System.Collections.Generic","pos":[11243,11269]},{"content":"System.Collections.Specialized","pos":[11344,11374]},{"content":"System.Linq","pos":[11453,11464]}],"content":"---\ntitle: Collections and Data Structures\ndescription: Collections and Data Structures\nkeywords: .NET, .NET Core\nauthor: mairaw\nmanager: wpickett\nms.date: 06/20/2016\nms.topic: article\nms.prod: .net-core\nms.technology: .net-core-technologies\nms.devlang: dotnet\nms.assetid: 9e70255a-c02a-4046-86b7-10c84bab2d38\n---\n\n# Collections and Data Structures\n\nSimilar data can often be handled more efficiently when stored and manipulated as a collection. You can use the [System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array) class or the classes in the [System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections), [System.Collections.Generic](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic), or [System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent) namespaces to add, remove, and modify either individual elements or a range of elements in a collection.\n\nThere are two main types of collections; generic collections and non-generic collections. Generic collections are type-safe at compile time. Because of this, generic collections typically offer better performance. Generic collections accept a type parameter when they are constructed and do not require that you cast to and from the [Object](https://docs.microsoft.com/dotnet/core/api/System.Object) type when you add or remove items from the collection. Non-generic collections store items as [Object](https://docs.microsoft.com/dotnet/core/api/System.Object) and require casting. You may see non-generic collections in older code.\n\nThe collections in the [System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent) namespace provide efficient thread-safe operations for accessing collection items from multiple threads.\n\n## Common collection features\n\nAll collections provide methods for adding, removing or finding items in the collection. In addition, all collections that directly or indirectly implement the [ICollection](https://docs.microsoft.com/dotnet/core/api/System.Collections.ICollection) interface or the [ICollection&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.ICollection-1) interface share these features: \n\n* **The ability to enumerate the collection**\n\n   .NET Framework collections either implement [System.Collections.IEnumerable](https://docs.microsoft.com/dotnet/core/api/System.Collections.IEnumerable) or [System.Collections.Generic.IEnumerable&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IEnumerable-1) to enable the collection to be iterated through. An enumerator can be thought of as a movable pointer to any element in the collection. The `foreach, in` statement (C#) uses the enumerator exposed by the `GetEnumerator` method and hides the complexity of manipulating the enumerator. In addition, any collection that implements [System.Collections.Generic.IEnumerable&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IEnumerable-1) is considered a queryable type and can be queried with LINQ. LINQ queries provide a common pattern for accessing data. They are typically more concise and readable than standard for each loops, and provide filtering, ordering and grouping capabilities. LINQ queries can also improve performance.\n    \n* **The ability to copy the collection contents to an array**\n\n   All collections can be copied to an array using the `CopyTo` method; however, the order of the elements in the new array is based on the sequence in which the enumerator returns them. The resulting array is always one-dimensional with a lower bound of zero.\n    \nIn addition, many collection classes contain the following features:\n\n* **Capacity and Count properties**\n\n   The capacity of a collection is the number of elements it can contain. The count of a collection is the number of elements it actually contains. Some collections hide the capacity or the count or both.\n    \n   Most collections automatically expand in capacity when the current capacity is reached. The memory is reallocated, and the elements are copied from the old collection to the new one. This reduces the code required to use the collection; however, the performance of the collection might be negatively affected. For example, for [List&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1), if `Count` is less than `Capacity`, adding an item is an O(1) operation. If the capacity needs to be increased to accommodate the new element, adding an item becomes an O(n) operation, where n is `Count`. The best way to avoid poor performance caused by multiple reallocations is to set the initial capacity to be the estimated size of the collection. \n    \n   A [BitArray](https://docs.microsoft.com/dotnet/core/api/System.Collections.BitArray) is a special case; its capacity is the same as its length, which is the same as its count.\n    \n*   **A consistent lower bound**\n\n   The lower bound of a collection is the index of its first element. All indexed collections in the [System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections) namespaces have a lower bound of zero, meaning they are 0-indexed. [Array](https://docs.microsoft.com/dotnet/core/api/System.Array) has a lower bound of zero by default, but a different lower bound can be defined when creating an instance of the `Array` class using `Array.CreateInstance`.\n\n*   **Synchronization for access from multiple threads** ([System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections) classes only).\n\n   Non-generic collection types in the [System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections) namespace provide some thread safety with synchronization; typically exposed through the `SyncRoot` and `IsSynchronized` members. These collections are not thread-safe by default. If you require scalable and efficient multi-threaded access to a collection, use one of the classes in the [System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent) namespace or consider using an immutable collection. For more information, see [Thread-Safe Collections](threadsafe/index.md).    \n    \n## Choosing a collection \n\nIn general, you should use generic collections. The following table describes some common collection scenarios and the collection classes you can use for those scenarios. If you are new to generic collections, this table will help you choose the generic collection that works the best for your task.\n\nI want to… | Generic collection option(s) | Non-generic collection option(s)\n---------- | ---------------------------- | --------------------------------\nStore items as key/value pairs for quick look-up by key | [System.Collections.Generic.Dictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2) | [Hashtable](https://docs.microsoft.com/dotnet/core/api/System.Collections.Hashtable)\nAccess items by index | [System.Collections.Generic.List&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1) | [System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array), [System.Collections.ArrayList](https://docs.microsoft.com/dotnet/core/api/System.Collections.ArrayList)\nUse items first-in-first-out (FIFO) | [System.Collections.Generic.Queue&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Queue-1) | [System.Collections.Queue](https://docs.microsoft.com/dotnet/core/api/System.Collections.Queue)\nUse data Last-In-First-Out (LIFO) | [System.Collections.Generic.Stack&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Stack-1) | [System.Collections.Stack](https://docs.microsoft.com/dotnet/core/api/System.Collections.Stack)\nAccess items sequentially | [System.Collections.Generic.LinkedList&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.LinkedList-1) | No recommendation\nReceive notifications when items are removed or added to the collection. (implements [INotifyPropertyChanged](https://docs.microsoft.com/dotnet/core/api/System.ComponentModel.INotifyPropertyChanged) and [INotifyCollectionChanged](https://docs.microsoft.com/dotnet/core/api/System.Collections.Specialized.INotifyCollectionChanged)) | [System.Collections.ObjectModel.ObservableCollection&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.ObjectModel.ObservableCollection-1) | No recommendation\nUse a sorted collection | [System.Collections.Generic.SortedList&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedList-2) | [System.Collections.SortedList](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList)\nManage efficient storage and access of unique elements | [System.Collections.Generic.HashSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.HashSet-1), [System.Collections.Generic.SortedSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedSet-1) | No recommendation\n\n## Related Topics\n\nTitle | Description\n----- | -----------\n[Selecting a Collection Class](selecting-a-collection-class.md) | Describes the different collections and helps you select one for your scenario.\n[Commonly Used Collection Types](commonly-used-collection-types.md) | Describes commonly used generic and nongeneric collection types such as [System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array), [System.Collections.Generic.List&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1), and [System.Collections.Generic.Dictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2). \n[When to Use Generic Collections](when-to-use-generic-collections.md) | Discusses the use of generic collection types.\n[Comparisons and Sorts Within Collections](comparisons-and-sorts-within-collections.md) | Discusses the use of equality comparisons and sorting comparisons in collections.\n[Sorted Collection Types](sorted-collection-types.md) | Describes sorted collections performance and characteristics.\n[Hashtable and Dictionary Collection Types](hashtable-and-dictionary-collection-types.md) | Describes the features of generic and non-generic hash-based dictionary types.\n[Thread-Safe Collections](threadsafe/index.md) | Describes collection types such as [System.Collections.Concurrent.BlockingCollection&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.BlockingCollection-1) and [System.Collections.Concurrent.ConcurrentBag&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentBag-1) that support safe and efficient concurrent access from multiple threads.\n\n## Reference\n\n[System.Array](https://docs.microsoft.com/dotnet/core/api/System.Array)\n\n[System.Collections](https://docs.microsoft.com/dotnet/core/api/System.Collections)\n\n[System.Collections.Concurrent](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent)\n\n[System.Collections.Generic](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic)\n\n[System.Collections.Specialized](https://docs.microsoft.com/dotnet/core/api/System.Collections.Specialized)\n\n[System.Linq](https://docs.microsoft.com/dotnet/core/api/System.Linq)\n  \n"}