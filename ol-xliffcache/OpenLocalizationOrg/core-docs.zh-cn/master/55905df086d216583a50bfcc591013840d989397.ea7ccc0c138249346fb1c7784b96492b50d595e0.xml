{"nodes":[{"pos":[11,74],"content":"Organizing Your Project to Support .NET Framework and .NET Core","needQuote":true,"nodes":[{"content":"Organizing Your Project to Support .NET Framework and .NET Core","pos":[0,63]}]},{"pos":[88,151],"content":"Organizing Your Project to Support .NET Framework and .NET Core","needQuote":true,"nodes":[{"content":"Organizing Your Project to Support .NET Framework and .NET Core","pos":[0,63]}]},{"pos":[162,177],"content":".NET, .NET Core","needQuote":true,"nodes":[{"content":".NET, .NET Core","pos":[0,15]}]},{"content":"Organizing Your Project to Support .NET Framework and .NET Core","pos":[382,445]},{"content":"This article is to help project owners who want to compile their solution against .NET Framework and .NET Core side-by-side.","pos":[447,571]},{"content":"It provides several options to organize projects to help developers achieve this goal.","pos":[573,659]},{"content":"Here are some typical scenarios to consider when you are deciding how to setup your project layout with .NET Core.","pos":[661,775]},{"content":"They may not cover everything you want; prioritize based on your project's needs.","pos":[777,858]},{"pos":[862,951],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Combine existing projects and .NET Core projects into single projects<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>option-xproj<ept id=\"p3\">]</ept>","source":"[**Combine existing projects and .NET Core projects into single projects**][option-xproj]"},{"content":"What this is good for:","pos":[958,980]},{"content":"Simplifying your build process by compiling a single project rather than compiling multiple projects, each targeting a different .NET Framework version or platform.","pos":[986,1150]},{"content":"Simplifying source file management for multi-targeted projects because you have to manage a single project file.","pos":[1155,1267]},{"content":"When adding/removing source files, the alternatives require you to manually sync these with your other projects.","pos":[1269,1381]},{"content":"Easily generating a NuGet package for consumption.","pos":[1386,1436]},{"content":"Allows you to write code for a specific .NET Framework version in your libraries through the use of compiler directives.","pos":[1441,1561]},{"content":"Unsupported scenarios:","pos":[1568,1590]},{"content":"Does not allow developers without Visual Studio 2015 to open existing projects.","pos":[1596,1675]},{"content":"To support older versions of Visual Studio, <bpt id=\"p1\">[</bpt>keeping your project files in different folders<ept id=\"p1\">](#support-vs)</ept> is a better option.","pos":[1676,1802],"source":" To support older versions of Visual Studio, [keeping your project files in different folders](#support-vs) is a better option."},{"content":"Does not allow you to share your .NET Core library across different project types in the same solution file.","pos":[1807,1915]},{"content":"To support this, <bpt id=\"p1\">[</bpt>creating a Portable Class Library<ept id=\"p1\">](#support-pcl)</ept> is a better option.","pos":[1916,2002],"source":" To support this, [creating a Portable Class Library](#support-pcl) is a better option."},{"content":"Does not allow for project build or load modifications that are supported by MSBuild Targets and Tasks.","pos":[2007,2110]},{"content":"To support this, <bpt id=\"p1\">[</bpt>creating a Portable Class Library<ept id=\"p1\">](#support-pcl)</ept> is a better option.","pos":[2111,2197],"source":" To support this, [creating a Portable Class Library](#support-pcl) is a better option."},{"pos":[2226,2311],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Keep existing projects and new .NET Core projects separate<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>option-xproj-folder<ept id=\"p3\">]</ept>","source":"[**Keep existing projects and new .NET Core projects separate**][option-xproj-folder]"},{"content":"What this is good for:","pos":[2318,2340]},{"content":"Continuing to support development on existing projects without having to upgrade for developers/contributors who may not have Visual Studio 2015.","pos":[2346,2491]},{"content":"Decreasing the possibility in creating new bugs in existing projects because no code churn is required in those projects.","pos":[2496,2617]},{"pos":[2647,2750],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Keep existing projects and create Portable Class Libraries (PCLs) targeting .NET Core<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>option-pcl<ept id=\"p3\">]</ept>","source":"[**Keep existing projects and create Portable Class Libraries (PCLs) targeting .NET Core**][option-pcl]"},{"content":"What this is good for:","pos":[2755,2777]},{"content":"Referencing your .NET Core libraries in desktop and/or web projects targeting the full .NET Framework in the same solution.","pos":[2783,2906]},{"content":"Supporting modifications in the project build or load process.","pos":[2911,2973]},{"content":"These modifications could be the inclusion of MSBuild Tasks and Targets in your <ph id=\"ph1\">`*.csproj`</ph> file.","pos":[2974,3070],"source":" These modifications could be the inclusion of MSBuild Tasks and Targets in your `*.csproj` file."},{"content":"Unsupported scenarios:","pos":[3075,3097]},{"pos":[3103,3258],"content":"Does not allow you to write code for a specific .NET Framework version because the <bpt id=\"p1\">[</bpt>predefined preprocessor symbols<ept id=\"p1\">]</ept><bpt id=\"p2\">[</bpt>how-to-multitarget<ept id=\"p2\">]</ept> are not supported.","source":"Does not allow you to write code for a specific .NET Framework version because the [predefined preprocessor symbols][how-to-multitarget] are not supported."},{"content":"Example","pos":[3263,3270]},{"content":"Consider the repository below:","pos":[3272,3302]},{"content":"Existing project","pos":[3306,3322]},{"pos":[3350,3397],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Source Code<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>example-initial-project-code<ept id=\"p3\">]</ept>","source":"[**Source Code**][example-initial-project-code]"},{"content":"There are several different ways to add support for .NET Core for this repository depending on the constraints and complexity of existing projects which are described below.","pos":[3399,3572]},{"content":"Replace Existing Projects with a Multi-targeted .NET Core Project (xproj)","pos":[3577,3650]},{"content":"The repository can be reorganized so that any existing <ph id=\"ph1\">`*.csproj`</ph> files are removed and a single <ph id=\"ph2\">`*.xproj`</ph> file is created that targets multiple frameworks.","pos":[3652,3808],"source":"The repository can be reorganized so that any existing `*.csproj` files are removed and a single `*.xproj` file is created that targets multiple frameworks."},{"content":"This is a great option because a single project is able to compile for different frameworks.","pos":[3810,3902]},{"content":"It also has the power to handle different compilation options, dependencies, etc.","pos":[3904,3985]},{"content":"per targeted framework.","pos":[3986,4009]},{"content":"Create an xproj that targets multiple frameworks","pos":[4013,4061]},{"pos":[4079,4116],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Source Code<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>example-xproj-code<ept id=\"p3\">]</ept>","source":"[**Source Code**][example-xproj-code]"},{"content":"Changes to note are:","pos":[4118,4138]},{"pos":[4141,4152],"content":"Addition of"},{"pos":[4169,4240],"content":"Replacement of <ph id=\"ph1\">`packages.config`</ph> and <ph id=\"ph2\">`*.csproj`</ph> with <ph id=\"ph3\">`project.json`</ph> and","source":"Replacement of `packages.config` and `*.csproj` with `project.json` and "},{"pos":[4253,4440],"content":"Changes in the <bpt id=\"p1\">[</bpt>Car's project.json<ept id=\"p1\">]</ept><bpt id=\"p2\">[</bpt>example-xproj-projectjson<ept id=\"p2\">]</ept> and its <bpt id=\"p3\">[</bpt>test project<ept id=\"p3\">]</ept><bpt id=\"p4\">[</bpt>example-xproj-projectjson-test<ept id=\"p4\">]</ept> to support building for the existing .NET Framework as well as others","source":"Changes in the [Car's project.json][example-xproj-projectjson] and its [test project][example-xproj-projectjson-test] to support building for the existing .NET Framework as well as others"},{"content":"Create a Portable Class Library (PCL) to target .NET Core","pos":[4445,4502]},{"pos":[4504,4631],"content":"If existing projects contain complex build operations or properties in their <ph id=\"ph1\">`*.csproj`</ph> file, it may be easier to create a PCL.","source":"If existing projects contain complex build operations or properties in their `*.csproj` file, it may be easier to create a PCL."},{"pos":[4651,4686],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Source Code<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>example-pcl-code<ept id=\"p3\">]</ept>","source":"[**Source Code**][example-pcl-code]"},{"content":"Changes to note are:","pos":[4688,4708]},{"pos":[4712,4738],"content":"Renaming <ph id=\"ph1\">`project.json`</ph> to","source":"Renaming `project.json` to "},{"content":"This prevents potential conflict in Visual Studio when trying to restore packages for the libraries in the same directory.","pos":[4775,4897]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>NuGet FAQ<ept id=\"p1\">](https://docs.nuget.org/consume/nuget-faq#working-with-packages)</ept> under \"<bpt id=\"p2\">_</bpt>I have multiple projects in the same folder, how can I use separate packages.config or project.json files for each project?<ept id=\"p2\">_</ept>\".","pos":[4898,5138],"source":" For more information, see the [NuGet FAQ](https://docs.nuget.org/consume/nuget-faq#working-with-packages) under \"_I have multiple projects in the same folder, how can I use separate packages.config or project.json files for each project?_\"."},{"content":"<bpt id=\"p1\">**</bpt>Alternative<ept id=\"p1\">**</ept>: Create the PCL in another folder and reference the original source code to avoid this issue.","pos":[5146,5255],"source":"**Alternative**: Create the PCL in another folder and reference the original source code to avoid this issue."},{"content":"Placing the PCL in another folder has an added benefit that users who do not have Visual Studio 2015 can still work on the older projects without loading the new solution.","pos":[5257,5428]},{"content":"To target .NET Standard after creating the PCL, in Visual Studio, open the <bpt id=\"p1\">**</bpt>Project's Properties<ept id=\"p1\">**</ept>.","pos":[5432,5532],"source":"To target .NET Standard after creating the PCL, in Visual Studio, open the **Project's Properties**."},{"content":"Under the <bpt id=\"p1\">**</bpt>Targets<ept id=\"p1\">**</ept> section, click on the link <bpt id=\"p2\">**</bpt>\"Target .NET Platform Standard\"<ept id=\"p2\">**</ept>.","pos":[5533,5618],"source":" Under the **Targets** section, click on the link **\"Target .NET Platform Standard\"**."},{"content":"This change can be reversed by repeating the same steps.","pos":[5620,5676]},{"content":"Keep Existing Projects and Create a .NET Core Project","pos":[5681,5734]},{"content":"If there are existing projects that target older frameworks, you may want to leave these projects untouched and use a .NET Core project to target future frameworks.","pos":[5736,5900]},{"content":".NET Core project with existing PCL in different folder","pos":[5904,5959]},{"pos":[5994,6041],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Source Code<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt>example-xproj-different-code<ept id=\"p3\">]</ept>","source":"[**Source Code**][example-xproj-different-code]"},{"content":"Changes to note are:","pos":[6043,6063]},{"content":"The .NET Core and existing projects are kept in separate folders.","pos":[6066,6131]},{"content":"This avoids the package restore issue that was mentioned above due to multiple project.json/package.config files being in the same folder.","pos":[6138,6276]},{"content":"Keeping projects in separate folders avoids forcing you to have Visual Studio 2015 (due to project.json).","pos":[6283,6388]},{"content":"You can create a separate solution that only opens the old projects.","pos":[6390,6458]},{"content":"See Also","pos":[6463,6471]},{"pos":[6473,6585],"content":"Please see <bpt id=\"p1\">[</bpt>.NET Core porting documentation<ept id=\"p1\">]</ept><bpt id=\"p2\">[</bpt>porting-doc<ept id=\"p2\">]</ept> for more guidance on moving to project.json and xproj.","source":"Please see [.NET Core porting documentation][porting-doc] for more guidance on moving to project.json and xproj."},{"content":"porting-doc","pos":[6588,6599]},{"pos":[6611,6692],"content":"<bpt id=\"p1\">[</bpt>example-initial-project<ept id=\"p1\">]: media/project-structure/project.png</ept><bpt id=\"p2\"> \"</bpt>Existing project<ept id=\"p2\">\"</ept>","source":"[example-initial-project]: media/project-structure/project.png \"Existing project\""},{"content":"example-initial-project-code","pos":[6694,6722]},{"pos":[6823,6932],"content":"<bpt id=\"p1\">[</bpt>example-xproj<ept id=\"p1\">]: media/project-structure/project.xproj.png</ept><bpt id=\"p2\"> \"</bpt>Create an xproj that targets multiple frameworks<ept id=\"p2\">\"</ept>","source":"[example-xproj]: media/project-structure/project.xproj.png \"Create an xproj that targets multiple frameworks\""},{"content":"example-xproj-code","pos":[6934,6952]},{"content":"example-xproj-projectjson","pos":[7059,7084]},{"content":"example-xproj-projectjson-test","pos":[7211,7241]},{"pos":[7376,7519],"content":"<bpt id=\"p1\">[</bpt>example-xproj-different-folder<ept id=\"p1\">]: media/project-structure/project.xproj.different.png</ept><bpt id=\"p2\"> \"</bpt>.NET Core project with existing PCL in different folder<ept id=\"p2\">\"</ept>","source":"[example-xproj-different-folder]: media/project-structure/project.xproj.different.png \".NET Core project with existing PCL in different folder\""},{"content":"example-xproj-different-code","pos":[7521,7549]},{"pos":[7668,7748],"content":"<bpt id=\"p1\">[</bpt>example-pcl<ept id=\"p1\">]: media/project-structure/project.pcl.png</ept><bpt id=\"p2\"> \"</bpt>PCL Targeting .NET Core<ept id=\"p2\">\"</ept>","source":"[example-pcl]: media/project-structure/project.pcl.png \"PCL Targeting .NET Core\""},{"content":"example-pcl-code","pos":[7750,7766]},{"content":"option-xproj","pos":[7871,7883]},{"content":"option-pcl","pos":[7959,7969]},{"content":"option-xproj-folder","pos":[8029,8048]},{"content":"how-to-multitarget","pos":[8107,8125]}],"content":"---\ntitle: Organizing Your Project to Support .NET Framework and .NET Core\ndescription: Organizing Your Project to Support .NET Framework and .NET Core\nkeywords: .NET, .NET Core\nauthor: conniey\nmanager: wpickett\nms.date: 07/18/2016\nms.topic: article\nms.prod: .net-core\nms.technology: .net-core-technologies\nms.devlang: dotnet\nms.assetid: 3af62252-1dfa-4336-8d2f-5cfdb57d7724\n---\n\n# Organizing Your Project to Support .NET Framework and .NET Core\n\nThis article is to help project owners who want to compile their solution against .NET Framework and .NET Core side-by-side.  It provides several options to organize projects to help developers achieve this goal.  Here are some typical scenarios to consider when you are deciding how to setup your project layout with .NET Core.  They may not cover everything you want; prioritize based on your project's needs.\n\n* [**Combine existing projects and .NET Core projects into single projects**][option-xproj]\n  \n  *What this is good for:*\n  * Simplifying your build process by compiling a single project rather than compiling multiple projects, each targeting a different .NET Framework version or platform.\n  * Simplifying source file management for multi-targeted projects because you have to manage a single project file.  When adding/removing source files, the alternatives require you to manually sync these with your other projects.\n  * Easily generating a NuGet package for consumption.\n  * Allows you to write code for a specific .NET Framework version in your libraries through the use of compiler directives.\n  \n  *Unsupported scenarios:*\n  * Does not allow developers without Visual Studio 2015 to open existing projects. To support older versions of Visual Studio, [keeping your project files in different folders](#support-vs) is a better option.\n  * Does not allow you to share your .NET Core library across different project types in the same solution file. To support this, [creating a Portable Class Library](#support-pcl) is a better option.\n  * Does not allow for project build or load modifications that are supported by MSBuild Targets and Tasks. To support this, [creating a Portable Class Library](#support-pcl) is a better option.\n\n* <a name=\"support-vs\"></a>[**Keep existing projects and new .NET Core projects separate**][option-xproj-folder]\n  \n  *What this is good for:*\n  * Continuing to support development on existing projects without having to upgrade for developers/contributors who may not have Visual Studio 2015.\n  * Decreasing the possibility in creating new bugs in existing projects because no code churn is required in those projects.\n\n* <a name=\"support-pcl\"></a>[**Keep existing projects and create Portable Class Libraries (PCLs) targeting .NET Core**][option-pcl]\n\n  *What this is good for:*\n  * Referencing your .NET Core libraries in desktop and/or web projects targeting the full .NET Framework in the same solution.\n  * Supporting modifications in the project build or load process. These modifications could be the inclusion of MSBuild Tasks and Targets in your `*.csproj` file.\n\n  *Unsupported scenarios:*\n  * Does not allow you to write code for a specific .NET Framework version because the [predefined preprocessor symbols][how-to-multitarget] are not supported.\n\n## Example\n\nConsider the repository below:\n\n![Existing project][example-initial-project]\n\n[**Source Code**][example-initial-project-code]\n\nThere are several different ways to add support for .NET Core for this repository depending on the constraints and complexity of existing projects which are described below.\n\n## Replace Existing Projects with a Multi-targeted .NET Core Project (xproj)\n\nThe repository can be reorganized so that any existing `*.csproj` files are removed and a single `*.xproj` file is created that targets multiple frameworks.  This is a great option because a single project is able to compile for different frameworks.  It also has the power to handle different compilation options, dependencies, etc. per targeted framework.\n\n![Create an xproj that targets multiple frameworks][example-xproj]\n\n[**Source Code**][example-xproj-code]\n\nChanges to note are:\n* Addition of `global.json`\n* Replacement of `packages.config` and `*.csproj` with `project.json` and `*.xproj`\n* Changes in the [Car's project.json][example-xproj-projectjson] and its [test project][example-xproj-projectjson-test] to support building for the existing .NET Framework as well as others\n\n## Create a Portable Class Library (PCL) to target .NET Core\n\nIf existing projects contain complex build operations or properties in their `*.csproj` file, it may be easier to create a PCL.\n\n![][example-pcl]\n\n[**Source Code**][example-pcl-code]\n\nChanges to note are:\n*  Renaming `project.json` to `{project-name}.project.json`\n    * This prevents potential conflict in Visual Studio when trying to restore packages for the libraries in the same directory. For more information, see the [NuGet FAQ](https://docs.nuget.org/consume/nuget-faq#working-with-packages) under \"_I have multiple projects in the same folder, how can I use separate packages.config or project.json files for each project?_\".\n    *  **Alternative**: Create the PCL in another folder and reference the original source code to avoid this issue.  Placing the PCL in another folder has an added benefit that users who do not have Visual Studio 2015 can still work on the older projects without loading the new solution.\n*  To target .NET Standard after creating the PCL, in Visual Studio, open the **Project's Properties**. Under the **Targets** section, click on the link **\"Target .NET Platform Standard\"**.  This change can be reversed by repeating the same steps.\n\n## Keep Existing Projects and Create a .NET Core Project\n\nIf there are existing projects that target older frameworks, you may want to leave these projects untouched and use a .NET Core project to target future frameworks.\n\n![.NET Core project with existing PCL in different folder][example-xproj-different-folder]\n\n[**Source Code**][example-xproj-different-code]\n\nChanges to note are:\n* The .NET Core and existing projects are kept in separate folders.\n    * This avoids the package restore issue that was mentioned above due to multiple project.json/package.config files being in the same folder.\n    * Keeping projects in separate folders avoids forcing you to have Visual Studio 2015 (due to project.json).  You can create a separate solution that only opens the old projects.\n\n## See Also\n\nPlease see [.NET Core porting documentation][porting-doc] for more guidance on moving to project.json and xproj.\n\n[porting-doc]: index.md\n[example-initial-project]: media/project-structure/project.png \"Existing project\"\n[example-initial-project-code]: https://github.com/dotnet/core-docs/tree/master/samples/core-projects/libraries/migrate-library/\n\n[example-xproj]: media/project-structure/project.xproj.png \"Create an xproj that targets multiple frameworks\"\n[example-xproj-code]: https://github.com/dotnet/core-docs/tree/master/samples/core-projects/libraries/migrate-library-xproj/\n[example-xproj-projectjson]: https://github.com/dotnet/core-docs/tree/master/samples/core-projects/libraries/migrate-library-xproj/src/Car/project.json\n[example-xproj-projectjson-test]: https://github.com/dotnet/core-docs/tree/master/samples/core-projects/libraries/migrate-library-xproj/tests/Car.Tests/project.json\n\n[example-xproj-different-folder]: media/project-structure/project.xproj.different.png \".NET Core project with existing PCL in different folder\"\n[example-xproj-different-code]: https://github.com/dotnet/core-docs/tree/master/samples/core-projects/libraries/migrate-library-xproj-keep-csproj/\n\n[example-pcl]: media/project-structure/project.pcl.png \"PCL Targeting .NET Core\"\n[example-pcl-code]: https://github.com/dotnet/core-docs/tree/master/samples/core-projects/libraries/migrate-library-pcl\n\n[option-xproj]: #replace-existing-projects-with-a-multi-targeted-net-core-project-xproj\n[option-pcl]: #create-a-portable-class-library-pcl-to-target-net-core\n[option-xproj-folder]: #keep-existing-projects-and-create-a-net-core-project\n\n[how-to-multitarget]: ../tutorials/libraries.md#how-to-multitarget\n"}