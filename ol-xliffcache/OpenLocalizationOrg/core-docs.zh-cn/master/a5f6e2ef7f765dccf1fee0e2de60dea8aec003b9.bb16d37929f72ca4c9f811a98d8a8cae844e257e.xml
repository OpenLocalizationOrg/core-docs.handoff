{"nodes":[{"pos":[11,34],"content":"Sorted Collection Types","needQuote":true,"nodes":[{"content":"Sorted Collection Types","pos":[0,23]}]},{"pos":[50,73],"content":"Sorted Collection Types","needQuote":true,"nodes":[{"content":"Sorted Collection Types","pos":[0,23]}]},{"pos":[86,101],"content":".NET, .NET Core","needQuote":true,"nodes":[{"content":".NET, .NET Core","pos":[0,15]}]},{"content":"Sorted Collection Types","pos":[305,328]},{"content":"The <bpt id=\"p1\">[</bpt>System.Collections.SortedList<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList)</ept> class, the <bpt id=\"p2\">[</bpt>System.Collections.Generic.SortedList<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedList-2)</ept> generic class, and the <bpt id=\"p3\">[</bpt>System.Collections.Generic.SortedDictionary<ph id=\"ph3\">&amp;lt;</ph>TKey, TValue<ph id=\"ph4\">&amp;gt;</ph><ept id=\"p3\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedDictionary-2)</ept> generic class are similar to the <bpt id=\"p4\">[</bpt>Hashtable<ept id=\"p4\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Hashtable)</ept> class and the <bpt id=\"p5\">[</bpt>Dictionary<ph id=\"ph5\">&amp;lt;</ph>TKey, TValue<ph id=\"ph6\">&amp;gt;</ph><ept id=\"p5\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2)</ept> generic class in that they implement the <bpt id=\"p6\">[</bpt>IDictionary<ept id=\"p6\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary)</ept> interface, but they maintain their elements in sort order by key, and they do not have the O(1) insertion and retrieval characteristic of hash tables.","pos":[334,1307],"source":"The [System.Collections.SortedList](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList) class, the [System.Collections.Generic.SortedList&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedList-2) generic class, and the [System.Collections.Generic.SortedDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedDictionary-2) generic class are similar to the [Hashtable](https://docs.microsoft.com/dotnet/core/api/System.Collections.Hashtable) class and the [Dictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2) generic class in that they implement the [IDictionary](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary) interface, but they maintain their elements in sort order by key, and they do not have the O(1) insertion and retrieval characteristic of hash tables."},{"content":"The three classes have several features in common:","pos":[1308,1358]},{"content":"All three classes implement the <bpt id=\"p1\">[</bpt>System.Collections.IDictionary<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary)</ept> interface.","pos":[1367,1517],"source":"All three classes implement the [System.Collections.IDictionary](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary) interface."},{"content":"The two generic classes also implement the <bpt id=\"p1\">[</bpt>System.Collections.Generic.IDictionary<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IDictionary-2)</ept> generic interface.","pos":[1518,1725],"source":" The two generic classes also implement the [System.Collections.Generic.IDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IDictionary-2) generic interface."},{"content":"Each element is a key/value pair for enumeration purposes.","pos":[1735,1793]},{"pos":[1802,2219],"content":"[!NOTE]  \nThe nongeneric [SortedList](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList) class returns [DictionaryEntry](https://docs.microsoft.com/dotnet/core/api/System.Collections.DictionaryEntry) objects when enumerated, although the two generic types return [KeyValuePair&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.KeyValuePair-2) objects.","leadings":["","> "],"nodes":[{"content":"The nongeneric <bpt id=\"p1\">[</bpt>SortedList<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList)</ept> class returns <bpt id=\"p2\">[</bpt>DictionaryEntry<ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.DictionaryEntry)</ept> objects when enumerated, although the two generic types return <bpt id=\"p3\">[</bpt>KeyValuePair<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p3\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.KeyValuePair-2)</ept> objects.","pos":[10,415],"source":"The nongeneric [SortedList](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList) class returns [DictionaryEntry](https://docs.microsoft.com/dotnet/core/api/System.Collections.DictionaryEntry) objects when enumerated, although the two generic types return [KeyValuePair&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.KeyValuePair-2) objects."}]},{"pos":[2230,2595],"content":"Elements are sorted according to a <bpt id=\"p1\">[</bpt>System.Collections.IComparer<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.IComparer)</ept> implementation (for nongeneric <ph id=\"ph1\">`SortedList`</ph>) or a <bpt id=\"p2\">[</bpt>System.Collections.Generic.IComparer<ph id=\"ph2\">&amp;lt;</ph>T<ph id=\"ph3\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IComparer-1)</ept> implementation (for the two generic classes).","source":"Elements are sorted according to a [System.Collections.IComparer](https://docs.microsoft.com/dotnet/core/api/System.Collections.IComparer) implementation (for nongeneric `SortedList`) or a [System.Collections.Generic.IComparer&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IComparer-1) implementation (for the two generic classes)."},{"content":"Each class provides properties that return collections containing only the keys or only the values.","pos":[2607,2706]},{"pos":[2713,2936],"content":"The following table lists some of the differences between the two sorted list classes and the <bpt id=\"p1\">[</bpt>SortedDictionary&lt;TKey, TValue&gt;<ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedDictionary-2)</ept> class.","source":"The following table lists some of the differences between the two sorted list classes and the [SortedDictionary<TKey, TValue>](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedDictionary-2) class."},{"pos":[2957,3018],"content":"nongeneric class and <ph id=\"ph1\">`SortedList&lt;TKey, TValue&gt;`</ph> generic class","source":" nongeneric class and `SortedList<TKey, TValue>` generic class"},{"pos":[3054,3067],"content":"generic class"},{"content":"The properties that return keys and values are indexed, allowing efficient indexed retrieval.","pos":[3189,3282]},{"content":"No indexed retrieval.","pos":[3285,3306]},{"content":"Retrieval is O(log n).","pos":[3310,3332]},{"content":"Retrieval is O(log n).","pos":[3335,3357]},{"content":"Insertion and removal are generally O(n); however, insertion is O(1) for data that are already in sort order, so that each element is added to the end of the list.","pos":[3361,3524]},{"content":"(This assumes that a resize is not required.)","pos":[3525,3570]},{"content":"Insertion and removal are O(log n).","pos":[3573,3608]},{"pos":[3612,3669],"content":"Uses less memory than a <ph id=\"ph1\">`SortedDictionary&lt;TKey, TValue&gt;`</ph>.","source":"Uses less memory than a `SortedDictionary<TKey, TValue>`."},{"pos":[3672,3777],"content":"Uses more memory than the <ph id=\"ph1\">`SortedList`</ph> nongeneric class and the <ph id=\"ph2\">`SortedList&lt;TKey, TValue&gt;`</ph> generic class.","source":"Uses more memory than the `SortedList` nongeneric class and the `SortedList<TKey, TValue>` generic class."},{"pos":[3784,4072],"content":"For sorted lists or dictionaries that must be accessible concurrently from multiple threads, you can add sorting logic to a class that derives from <bpt id=\"p1\">[</bpt>ConcurrentDictionary<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentDictionary-2)</ept>.","source":"For sorted lists or dictionaries that must be accessible concurrently from multiple threads, you can add sorting logic to a class that derives from [ConcurrentDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentDictionary-2)."},{"pos":[4081,4390],"content":"[!NOTE]  \nFor values that contain their own keys (for example, employee records that contain an employee ID number), you can create a keyed collection that has some characteristics of a list and some characteristics of a dictionary by deriving from the [KeyedCollection&lt;TKey, TItem&gt;]() generic class.","leadings":[""," > "],"nodes":[{"content":"For values that contain their own keys (for example, employee records that contain an employee ID number), you can create a keyed collection that has some characteristics of a list and some characteristics of a dictionary by deriving from the <bpt id=\"p1\">[</bpt>KeyedCollection<ph id=\"ph1\">&amp;lt;</ph>TKey, TItem<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">]()</ept> generic class.","pos":[10,306],"source":"For values that contain their own keys (for example, employee records that contain an employee ID number), you can create a keyed collection that has some characteristics of a list and some characteristics of a dictionary by deriving from the [KeyedCollection&lt;TKey, TItem&gt;]() generic class."}]},{"content":"The <bpt id=\"p1\">[</bpt>SortedSet<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedSet-1)</ept> class provides a self-balancing tree that maintains data in sorted order after insertions, deletions, and searches.","pos":[4398,4621],"source":"The [SortedSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedSet-1) class provides a self-balancing tree that maintains data in sorted order after insertions, deletions, and searches."},{"content":"This class and the <bpt id=\"p1\">[</bpt>HashSet<ph id=\"ph1\">&amp;lt;</ph>T<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.HashSet-1)</ept> class implement the <bpt id=\"p2\">[</bpt>ISet<ph id=\"ph3\">&amp;lt;</ph>T<ph id=\"ph4\">&amp;gt;</ph><ept id=\"p2\">](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.ISet-1)</ept> interface.","pos":[4622,4865],"source":" This class and the [HashSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.HashSet-1) class implement the [ISet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.ISet-1) interface."},{"content":"See Also","pos":[4875,4883]},{"content":"System.Collections.IDictionary","pos":[4890,4920]},{"content":"System.Collections.Generic.IDictionary<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue","pos":[5004,5058],"source":"System.Collections.Generic.IDictionary&lt;TKey, TValue"},{"content":"ConcurrentDictionary<ph id=\"ph1\">&amp;lt;</ph>TKey, TValue","pos":[5156,5192],"source":"ConcurrentDictionary&lt;TKey, TValue"},{"content":"Commonly Used Collection Types","pos":[5300,5330]}],"content":"---\ntitle: Sorted Collection Types  \ndescription: Sorted Collection Types  \nkeywords: .NET, .NET Core\nauthor: mairaw\nmanager: wpickett\nms.date: 06/20/2016\nms.topic: article\nms.prod: .net-core\nms.technology: .net-core-technologies\nms.devlang: dotnet\nms.assetid: bdc9c13e-e56a-433b-a293-c92364f6e9cb\n---\n\n# Sorted Collection Types  \n \n The [System.Collections.SortedList](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList) class, the [System.Collections.Generic.SortedList&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedList-2) generic class, and the [System.Collections.Generic.SortedDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedDictionary-2) generic class are similar to the [Hashtable](https://docs.microsoft.com/dotnet/core/api/System.Collections.Hashtable) class and the [Dictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2) generic class in that they implement the [IDictionary](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary) interface, but they maintain their elements in sort order by key, and they do not have the O(1) insertion and retrieval characteristic of hash tables. The three classes have several features in common:  \n\n *   All three classes implement the [System.Collections.IDictionary](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary) interface. The two generic classes also implement the [System.Collections.Generic.IDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IDictionary-2) generic interface.  \n \n *   Each element is a key/value pair for enumeration purposes.   \n  \n> [!NOTE]  \n> The nongeneric [SortedList](https://docs.microsoft.com/dotnet/core/api/System.Collections.SortedList) class returns [DictionaryEntry](https://docs.microsoft.com/dotnet/core/api/System.Collections.DictionaryEntry) objects when enumerated, although the two generic types return [KeyValuePair&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.KeyValuePair-2) objects.  \n   \n*   Elements are sorted according to a [System.Collections.IComparer](https://docs.microsoft.com/dotnet/core/api/System.Collections.IComparer) implementation (for nongeneric `SortedList`) or a [System.Collections.Generic.IComparer&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IComparer-1) implementation (for the two generic classes).  \n   \n *   Each class provides properties that return collections containing only the keys or only the values.  \n   \nThe following table lists some of the differences between the two sorted list classes and the [SortedDictionary<TKey, TValue>](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedDictionary-2) class.  \n   \n `SortedList` nongeneric class and `SortedList<TKey, TValue>` generic class | `SortedDictionary<TKey, TValue>` generic class  \n --------------------------------------------------------------------------------- | ------------------------------  \n The properties that return keys and values are indexed, allowing efficient indexed retrieval. | No indexed retrieval.  \n Retrieval is O(log n). | Retrieval is O(log n).  \n Insertion and removal are generally O(n); however, insertion is O(1) for data that are already in sort order, so that each element is added to the end of the list. (This assumes that a resize is not required.) | Insertion and removal are O(log n).  \n Uses less memory than a `SortedDictionary<TKey, TValue>`. | Uses more memory than the `SortedList` nongeneric class and the `SortedList<TKey, TValue>` generic class.  \n  \n For sorted lists or dictionaries that must be accessible concurrently from multiple threads, you can add sorting logic to a class that derives from [ConcurrentDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentDictionary-2).  \n  \n > [!NOTE]  \n > For values that contain their own keys (for example, employee records that contain an employee ID number), you can create a keyed collection that has some characteristics of a list and some characteristics of a dictionary by deriving from the [KeyedCollection&lt;TKey, TItem&gt;]() generic class.  \n   \n The [SortedSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.SortedSet-1) class provides a self-balancing tree that maintains data in sorted order after insertions, deletions, and searches. This class and the [HashSet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.HashSet-1) class implement the [ISet&lt;T&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.ISet-1) interface.  \n   \n## See Also  \n  \n[System.Collections.IDictionary](https://docs.microsoft.com/dotnet/core/api/System.Collections.IDictionary)  \n   \n[System.Collections.Generic.IDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IDictionary-2)  \n   \n[ConcurrentDictionary&lt;TKey, TValue&gt;](https://docs.microsoft.com/dotnet/core/api/System.Collections.Concurrent.ConcurrentDictionary-2)  \n \n[Commonly Used Collection Types](commonly-used-collection-types.md) \n"}